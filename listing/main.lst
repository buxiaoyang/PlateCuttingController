C51 COMPILER V7.50   MAIN                                                                  05/23/2014 21:42:08 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\output\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE source\main.c LARGE BROWSE INCDIR(.\include\) DEBUG OBJECTEXTEND PRINT(.\li
                    -sting\main.lst) OBJECT(.\output\main.obj)

line level    source

   1          /***************************************************************************/
   2          // 程序：清洗设备控制器
   3          // 模块：主函数 
   4          // 文件：main.c
   5          // 作者：卜晓D
   6          // 版本：V0.02
   7          // 日期：2013年11月8日
   8          // 功能：主函数
   9          // 芯片：STC12C5A60S2
  10          // 编译：Keil uVision3 V3.90
  11          /***************************************************************************/
  12          
  13          #include <reg52.h>
  14          #include <basefunc.h>
  15          #include <parameter.h>
  16          #include <uart.h>
  17          
  18          sbit MotorForward               = P1^5;  //     电机前进
  19          sbit MotorBack                  = P1^6;  // 电机后退
  20          sbit EncoderCounting    = P3^2;  // 编码器计数（绿色）
  21          sbit EncoderDirection   = P2^4;  // 编码器方向（白色）
  22          sbit TestOut =  P2^7; //T0
  23          
  24          
  25          //External interrupt0 service routine
  26          void exint0() interrupt 0           //(location at 0003H)
  27          {
  28   1              if(EncoderDirection == 0)
  29   1              {
  30   2                      currentlySignalNum --;
  31   2              }
  32   1              else
  33   1              {
  34   2                      currentlySignalNum ++;
  35   2              }       
  36   1      }
  37          
  38          void exterInterInit()
  39          {
  40   1              IT0 = 1;                        //set INT0 int type (1:Falling 0:Low level)
  41   1          EX0 = 1;                        //enable INT0 interrupt
  42   1          EA = 1;                         //open global interrupt switch
  43   1              
  44   1      }
  45          
  46          /***************************************************************************/
  47          // 主函数
  48          // 参数：无
  49          // 返回值：无   
  50          /***************************************************************************/
  51          void main()
  52          {
  53   1              exterInterInit();
  54   1              uart_init();
C51 COMPILER V7.50   MAIN                                                                  05/23/2014 21:42:08 PAGE 2   

  55   1      
  56   1      
  57   1              currentlySignalNum = 0; 
  58   1              MotorForward = 0;
  59   1              MotorBack = 1;
  60   1              parameterSignalNumPerMeter = 65535;
  61   1              while(1)
  62   1              {
  63   2                      currentlyBoardLength = (currentlySignalNum*1000)/parameterSignalNumPerMeter;    
  64   2                      SendData(0x5A);
  65   2                      SendData(0xA5);
  66   2                      SendData(0x07);
  67   2                      SendData(0x82);
  68   2                      SendData(0x00);
  69   2                      SendData(0x1F);
  70   2                      SendData(0x00);
  71   2                      SendData(0x00);
  72   2                      SendData(currentlyBoardLength>>8);
  73   2                      SendData(currentlyBoardLength);
  74   2              }   
  75   1      }
  76          
  77          
  78          
  79          
  80          
  81          
  82          
  83          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    244    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
